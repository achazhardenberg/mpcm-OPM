{
    "contents" : "---\noutput: html_document\n---\n```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}\nsetwd(\"~/Documents/PPA book chapter\")\nrm(list=ls())\n```\nOnline Practice Material for Section 8.4\n========================================================\n*Gonzalez-Voyer A. and von Hardenberg A. (2014) An Introduction to Phylogenetic Path Analysis. In: Garamszegi L.Z. (Ed.) \"Modern Phylogenetic Comparative Methods and Their Application in Evolutionary Biology\". Springer-Verlag, Berlin Heidelberg*\n  \nSimulation of tree and data for the Rhinograds example\n-------------------------------------------------------\nIn this tutorial we will show how we simulated the Rhinogradentia life history data and the related phylogenetic tree. You can use this code to generate your own data with an underlying phylogenetic signal to play around and test PPA and other phylogenetic comparative methods. Please be aware that if you generate new rhino.csv and a new rhino.tree files and then use them instead of the provided files to follow the Rhinograds example (OPM Section 8.4), you will get different estimates for statistics and parameters as those reported in the book chapter, as the underlying data and tree will be different. Although, you still should get qualitativelly similar results, as the underlying correlation matrix among the variables and Pagel's lambda are fixed. You can of course also play with these parameters and change completely the underlying \"true\" causal structure (changing the correlation matrix) and the degree of phylogenetic signal (changing Pagel's lambda value).  \n\nYou will need  the packages: ```ape``` and  ```geiger``` (including all dependencies):\n\n\n```{r  message=FALSE, warning=FALSE, comment=NA, tidy=TRUE}\nlibrary(ape)\nlibrary(geiger)\n```\n\nNow let's build the correlation matrix among the five variables according to the true causal structure implied by model 8 (Fig. 8.7 in the book). For simplicity, we fix the correlation coefficient of all direct causal links to 0.5. The correlation coefficient of two variables not directly linked, but for which there is a causal pathway passing through a third variable, will be given by the product of the correlation coefficients of the directly linked variables. For example, for the indirect causal link between BM and DD, which passes through NL (BM->NL->DD), the correlation coefficient will be 0.5x0.5 = 0.25. Following the same reasoning, the correlation coefficient between LS and DD, will be given by the product of the correlations between BM-LS, BM-NL and NL-DD and thus 0.5x0.5x0.5 = 0.125. Variables without any causal link between them have a correlation of 0. The order of the variables in the matrix is the following: BM, NL, LS, DD, RS:\n\n```{r  message=FALSE, warning=FALSE, comment=NA, tidy=TRUE}\nmat<-matrix(c(1,0.5,0.5,0.25,0,0.5,1,0.25,0.5,0.5,0.5,0.25,1,0.125,0,0.25,0.5,0.125,1,0.25,0,0.5,0,0.25,1),5,5) \nrownames(mat)<-c(\"BM\",\"NL\",\"LS\",\"DD\",\"RS\")\ncolnames(mat)<-c(\"BM\",\"NL\",\"LS\",\"DD\",\"RS\")\nprint(mat)\n```\n\nNow we simulate a phylogenetic tree for 100 species. We can plot this tree to see what it looks like, and then we save it in the Newick format for future use (it will be saved in your working directory). We give it a different name (```rhino2.tree```), than the phylogenetic tree file used in the OPM of section 8.4 (```rhino.tree```), to avoid confusion:\n\n\n```{r  message=FALSE, warning=FALSE, comment=NA, tidy=TRUE}\ntree<-drop.tip(sim.bdtree(b=1, d=0, stop=\"taxa\", n=101), \"s101\")\nplot(tree,cex=0.5,no.margin=T)\nwrite.tree(tree, file=\"rhino2.tree\")\n```\n\nAnd now we finally simulate the data providing the phylogenetic tree we just created, the correlation matrix (```mat```) defining the underlying causal structure and fixing Pagel's lambda to 0.8. We save this data file as csv file in your working directory calling it ```rhino2.csv```\n\n```{r  message=FALSE, warning=FALSE, comment=NA, tidy=TRUE}\ndata<-data.frame(sim.char(rescale(tree, model=\"lambda\",0.8), mat, nsim=1, model=\"BM\"))\nnames(data)<-c(\"BM\",\"NL\",\"LS\",\"DD\",\"RS\")\nSP<-row.names(data)\ndata<-cbind(SP, data)\nwrite.csv(data, file=\"rhino2.csv\")\n```\n\n\n\n",
    "created" : 1411375904699.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "712284231",
    "id" : "E11F5C0D",
    "lastKnownWriteTime" : 1410438121,
    "path" : "~/Documents/R projects/mpcm OPM/OPM simulatedData.Rmd",
    "project_path" : "OPM simulatedData.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}